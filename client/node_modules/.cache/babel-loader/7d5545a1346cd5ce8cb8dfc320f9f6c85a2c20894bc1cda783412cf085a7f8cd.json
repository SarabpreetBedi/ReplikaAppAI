{"ast":null,"code":"var _jsxFileName = \"D:\\\\ReplikaApp\\\\client\\\\src\\\\components\\\\Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport styled from 'styled-components';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { FiSend, FiPlus, FiMessageCircle, FiUser, FiSmartphone } from 'react-icons/fi';\nimport io from 'socket.io-client';\nimport axios from 'axios';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatContainer = styled.div`\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(20px);\n`;\n_c = ChatContainer;\nconst ChatHeader = styled.div`\n  padding: 20px 30px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  background: rgba(255, 255, 255, 0.9);\n`;\n_c2 = ChatHeader;\nconst HeaderTitle = styled.h2`\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: #333;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n_c3 = HeaderTitle;\nconst NewChatButton = styled(motion.button)`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 20px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border: none;\n  border-radius: 8px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);\n  }\n`;\n_c4 = NewChatButton;\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px 30px;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n`;\n_c5 = MessagesContainer;\nconst Message = styled(motion.div)`\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  max-width: 80%;\n  align-self: ${props => props.sender === 'user' ? 'flex-end' : 'flex-start'};\n`;\n_c6 = Message;\nconst MessageAvatar = styled.div`\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.2rem;\n  color: white;\n  background: ${props => props.sender === 'user' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'};\n  flex-shrink: 0;\n`;\n_c7 = MessageAvatar;\nconst MessageContent = styled.div`\n  background: ${props => props.sender === 'user' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'rgba(255, 255, 255, 0.9)'};\n  color: ${props => props.sender === 'user' ? 'white' : '#333'};\n  padding: 15px 20px;\n  border-radius: 18px;\n  border-bottom-right-radius: ${props => props.sender === 'user' ? '5px' : '18px'};\n  border-bottom-left-radius: ${props => props.sender === 'user' ? '18px' : '5px'};\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\n  line-height: 1.5;\n  word-wrap: break-word;\n  max-width: 100%;\n`;\n_c8 = MessageContent;\nconst MessageTime = styled.div`\n  font-size: 0.8rem;\n  color: #666;\n  margin-top: 5px;\n  text-align: ${props => props.sender === 'user' ? 'right' : 'left'};\n`;\n_c9 = MessageTime;\nconst InputContainer = styled.div`\n  padding: 20px 30px;\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n  background: rgba(255, 255, 255, 0.9);\n`;\n_c0 = InputContainer;\nconst InputForm = styled.form`\n  display: flex;\n  gap: 15px;\n  align-items: flex-end;\n`;\n_c1 = InputForm;\nconst MessageInput = styled.textarea`\n  flex: 1;\n  padding: 15px 20px;\n  border: 2px solid #e1e5e9;\n  border-radius: 25px;\n  font-size: 1rem;\n  resize: none;\n  min-height: 50px;\n  max-height: 120px;\n  font-family: inherit;\n  transition: all 0.3s ease;\n  background: #f8f9fa;\n\n  &:focus {\n    outline: none;\n    border-color: #667eea;\n    background: white;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n  }\n`;\n_c10 = MessageInput;\nconst SendButton = styled(motion.button)`\n  width: 50px;\n  height: 50px;\n  border-radius: 50%;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  border: none;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  font-size: 1.2rem;\n  transition: all 0.3s ease;\n\n  &:hover {\n    transform: scale(1.1);\n    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n_c11 = SendButton;\nconst TypingIndicator = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 15px 20px;\n  color: #666;\n  font-style: italic;\n`;\n_c12 = TypingIndicator;\nconst TypingDots = styled.div`\n  display: flex;\n  gap: 4px;\n`;\n_c13 = TypingDots;\nconst Dot = styled.div`\n  width: 8px;\n  height: 8px;\n  border-radius: 50%;\n  background: #667eea;\n  animation: typing 1.4s infinite ease-in-out;\n\n  &:nth-child(1) { animation-delay: -0.32s; }\n  &:nth-child(2) { animation-delay: -0.16s; }\n  &:nth-child(3) { animation-delay: 0s; }\n\n  @keyframes typing {\n    0%, 80%, 100% {\n      transform: scale(0.8);\n      opacity: 0.5;\n    }\n    40% {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n`;\n_c14 = Dot;\nconst WelcomeMessage = styled.div`\n  text-align: center;\n  padding: 40px;\n  color: #666;\n`;\n_c15 = WelcomeMessage;\nconst WelcomeTitle = styled.h3`\n  font-size: 1.5rem;\n  margin-bottom: 10px;\n  color: #333;\n`;\n_c16 = WelcomeTitle;\nconst WelcomeText = styled.p`\n  font-size: 1.1rem;\n  line-height: 1.6;\n  max-width: 500px;\n  margin: 0 auto;\n`;\n_c17 = WelcomeText;\nfunction Chat({\n  user\n}) {\n  _s();\n  const {\n    conversationId\n  } = useParams();\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [typing, setTyping] = useState(false);\n  const [socket, setSocket] = useState(null);\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n  useEffect(() => {\n    // Initialize socket connection\n    const newSocket = io('http://localhost:5000');\n    setSocket(newSocket);\n    if (conversationId) {\n      newSocket.emit('join-conversation', conversationId);\n      fetchMessages();\n    }\n    newSocket.on('new-message', message => {\n      setMessages(prev => [...prev, message]);\n      setTyping(false);\n    });\n    newSocket.on('error', error => {\n      toast.error(error.error);\n    });\n    return () => newSocket.close();\n  }, [conversationId]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  const fetchMessages = async () => {\n    try {\n      const response = await axios.get(`/api/messages/${conversationId}`);\n      setMessages(response.data);\n    } catch (error) {\n      console.error('Error fetching messages:', error);\n      toast.error('Failed to load messages');\n    }\n  };\n  const createNewConversation = async () => {\n    try {\n      const response = await axios.post('/api/conversations', {\n        userId: user.userId,\n        title: 'New Conversation'\n      });\n      navigate(`/chat/${response.data.conversationId}`);\n    } catch (error) {\n      console.error('Error creating conversation:', error);\n      toast.error('Failed to create conversation');\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!newMessage.trim() || loading) return;\n    const messageText = newMessage.trim();\n    setNewMessage('');\n    setLoading(true);\n    setTyping(true);\n    if (!conversationId) {\n      // Create new conversation\n      try {\n        const response = await axios.post('/api/conversations', {\n          userId: user.userId,\n          title: messageText.substring(0, 50) + '...'\n        });\n        navigate(`/chat/${response.data.conversationId}`);\n\n        // Send message after navigation\n        setTimeout(() => {\n          socket.emit('send-message', {\n            message: messageText,\n            conversationId: response.data.conversationId,\n            userId: user.userId,\n            personalityId: null\n          });\n        }, 100);\n      } catch (error) {\n        console.error('Error creating conversation:', error);\n        toast.error('Failed to create conversation');\n        setLoading(false);\n        setTyping(false);\n      }\n    } else {\n      // Send message to existing conversation\n      socket.emit('send-message', {\n        message: messageText,\n        conversationId,\n        userId: user.userId,\n        personalityId: null\n      });\n    }\n  };\n  const formatTime = timestamp => {\n    return new Date(timestamp).toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  if (!conversationId) {\n    return /*#__PURE__*/_jsxDEV(ChatContainer, {\n      children: [/*#__PURE__*/_jsxDEV(ChatHeader, {\n        children: /*#__PURE__*/_jsxDEV(HeaderTitle, {\n          children: [/*#__PURE__*/_jsxDEV(FiMessageCircle, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 352,\n            columnNumber: 13\n          }, this), \"New Chat\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(WelcomeMessage, {\n        children: [/*#__PURE__*/_jsxDEV(WelcomeTitle, {\n          children: \"Start a New Conversation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(WelcomeText, {\n          children: \"Begin chatting with your AI companion. Share your thoughts, ask questions, or just have a casual conversation. Your AI will remember your preferences and use your custom knowledge to provide personalized responses.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 356,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InputContainer, {\n        children: /*#__PURE__*/_jsxDEV(InputForm, {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(MessageInput, {\n            ref: inputRef,\n            value: newMessage,\n            onChange: e => setNewMessage(e.target.value),\n            placeholder: \"Type your message here...\",\n            rows: 1,\n            onKeyPress: e => {\n              if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                handleSubmit(e);\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n            type: \"submit\",\n            disabled: !newMessage.trim() || loading,\n            whileHover: {\n              scale: 1.1\n            },\n            whileTap: {\n              scale: 0.9\n            },\n            children: /*#__PURE__*/_jsxDEV(FiSend, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 385,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(ChatContainer, {\n    children: [/*#__PURE__*/_jsxDEV(ChatHeader, {\n      children: [/*#__PURE__*/_jsxDEV(HeaderTitle, {\n        children: [/*#__PURE__*/_jsxDEV(FiMessageCircle, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this), \"Chat\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NewChatButton, {\n        onClick: createNewConversation,\n        whileHover: {\n          scale: 1.05\n        },\n        whileTap: {\n          scale: 0.95\n        },\n        children: [/*#__PURE__*/_jsxDEV(FiPlus, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 11\n        }, this), \"New Chat\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MessagesContainer, {\n      children: [/*#__PURE__*/_jsxDEV(AnimatePresence, {\n        children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(Message, {\n          sender: message.sender,\n          initial: {\n            opacity: 0,\n            y: 20\n          },\n          animate: {\n            opacity: 1,\n            y: 0\n          },\n          transition: {\n            duration: 0.3\n          },\n          children: [/*#__PURE__*/_jsxDEV(MessageAvatar, {\n            sender: message.sender,\n            children: message.sender === 'user' ? /*#__PURE__*/_jsxDEV(FiUser, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 46\n            }, this) : /*#__PURE__*/_jsxDEV(FiBot, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 59\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(MessageContent, {\n              sender: message.sender,\n              children: message.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 424,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(MessageTime, {\n              sender: message.sender,\n              children: formatTime(message.timestamp)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 427,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 15\n          }, this)]\n        }, message.id || index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this), typing && /*#__PURE__*/_jsxDEV(Message, {\n        sender: \"ai\",\n        children: [/*#__PURE__*/_jsxDEV(MessageAvatar, {\n          sender: \"ai\",\n          children: /*#__PURE__*/_jsxDEV(FiBot, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(TypingIndicator, {\n            children: [\"AI is typing\", /*#__PURE__*/_jsxDEV(TypingDots, {\n              children: [/*#__PURE__*/_jsxDEV(Dot, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 444,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Dot, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 445,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Dot, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 446,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(InputContainer, {\n      children: /*#__PURE__*/_jsxDEV(InputForm, {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(MessageInput, {\n          ref: inputRef,\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value),\n          placeholder: \"Type your message here...\",\n          rows: 1,\n          onKeyPress: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleSubmit(e);\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 458,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n          type: \"submit\",\n          disabled: !newMessage.trim() || loading,\n          whileHover: {\n            scale: 1.1\n          },\n          whileTap: {\n            scale: 0.9\n          },\n          children: /*#__PURE__*/_jsxDEV(FiSend, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 457,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 394,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"68fAPwVBUG/AI6WPX7H+H0qQm5U=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c18 = Chat;\nexport default Chat;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18;\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"ChatHeader\");\n$RefreshReg$(_c3, \"HeaderTitle\");\n$RefreshReg$(_c4, \"NewChatButton\");\n$RefreshReg$(_c5, \"MessagesContainer\");\n$RefreshReg$(_c6, \"Message\");\n$RefreshReg$(_c7, \"MessageAvatar\");\n$RefreshReg$(_c8, \"MessageContent\");\n$RefreshReg$(_c9, \"MessageTime\");\n$RefreshReg$(_c0, \"InputContainer\");\n$RefreshReg$(_c1, \"InputForm\");\n$RefreshReg$(_c10, \"MessageInput\");\n$RefreshReg$(_c11, \"SendButton\");\n$RefreshReg$(_c12, \"TypingIndicator\");\n$RefreshReg$(_c13, \"TypingDots\");\n$RefreshReg$(_c14, \"Dot\");\n$RefreshReg$(_c15, \"WelcomeMessage\");\n$RefreshReg$(_c16, \"WelcomeTitle\");\n$RefreshReg$(_c17, \"WelcomeText\");\n$RefreshReg$(_c18, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useNavigate","styled","motion","AnimatePresence","FiSend","FiPlus","FiMessageCircle","FiUser","FiSmartphone","io","axios","toast","jsxDEV","_jsxDEV","ChatContainer","div","_c","ChatHeader","_c2","HeaderTitle","h2","_c3","NewChatButton","button","_c4","MessagesContainer","_c5","Message","props","sender","_c6","MessageAvatar","_c7","MessageContent","_c8","MessageTime","_c9","InputContainer","_c0","InputForm","form","_c1","MessageInput","textarea","_c10","SendButton","_c11","TypingIndicator","_c12","TypingDots","_c13","Dot","_c14","WelcomeMessage","_c15","WelcomeTitle","h3","_c16","WelcomeText","p","_c17","Chat","user","_s","conversationId","navigate","messages","setMessages","newMessage","setNewMessage","loading","setLoading","typing","setTyping","socket","setSocket","messagesEndRef","inputRef","newSocket","emit","fetchMessages","on","message","prev","error","close","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","response","get","data","console","createNewConversation","post","userId","title","handleSubmit","e","preventDefault","trim","messageText","substring","setTimeout","personalityId","formatTime","timestamp","Date","toLocaleTimeString","hour","minute","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","ref","value","onChange","target","placeholder","rows","onKeyPress","key","shiftKey","type","disabled","whileHover","scale","whileTap","onClick","map","index","initial","opacity","y","animate","transition","duration","FiBot","content","id","_c18","$RefreshReg$"],"sources":["D:/ReplikaApp/client/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n  FiSend, \r\n  FiPlus, \r\n  FiMessageCircle,\r\n  FiUser,\r\n  FiSmartphone\r\n} from 'react-icons/fi';\r\nimport io from 'socket.io-client';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst ChatContainer = styled.div`\r\n  height: 100vh;\r\n  display: flex;\r\n  flex-direction: column;\r\n  background: rgba(255, 255, 255, 0.95);\r\n  backdrop-filter: blur(20px);\r\n`;\r\n\r\nconst ChatHeader = styled.div`\r\n  padding: 20px 30px;\r\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  background: rgba(255, 255, 255, 0.9);\r\n`;\r\n\r\nconst HeaderTitle = styled.h2`\r\n  font-size: 1.5rem;\r\n  font-weight: 600;\r\n  color: #333;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n`;\r\n\r\nconst NewChatButton = styled(motion.button)`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 10px 20px;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  color: white;\r\n  border: none;\r\n  border-radius: 8px;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n\r\n  &:hover {\r\n    transform: translateY(-2px);\r\n    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);\r\n  }\r\n`;\r\n\r\nconst MessagesContainer = styled.div`\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 20px 30px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20px;\r\n`;\r\n\r\nconst Message = styled(motion.div)`\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 12px;\r\n  max-width: 80%;\r\n  align-self: ${props => props.sender === 'user' ? 'flex-end' : 'flex-start'};\r\n`;\r\n\r\nconst MessageAvatar = styled.div`\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 1.2rem;\r\n  color: white;\r\n  background: ${props => props.sender === 'user' \r\n    ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'\r\n    : 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'\r\n  };\r\n  flex-shrink: 0;\r\n`;\r\n\r\nconst MessageContent = styled.div`\r\n  background: ${props => props.sender === 'user' \r\n    ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'\r\n    : 'rgba(255, 255, 255, 0.9)'\r\n  };\r\n  color: ${props => props.sender === 'user' ? 'white' : '#333'};\r\n  padding: 15px 20px;\r\n  border-radius: 18px;\r\n  border-bottom-right-radius: ${props => props.sender === 'user' ? '5px' : '18px'};\r\n  border-bottom-left-radius: ${props => props.sender === 'user' ? '18px' : '5px'};\r\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);\r\n  line-height: 1.5;\r\n  word-wrap: break-word;\r\n  max-width: 100%;\r\n`;\r\n\r\nconst MessageTime = styled.div`\r\n  font-size: 0.8rem;\r\n  color: #666;\r\n  margin-top: 5px;\r\n  text-align: ${props => props.sender === 'user' ? 'right' : 'left'};\r\n`;\r\n\r\nconst InputContainer = styled.div`\r\n  padding: 20px 30px;\r\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\r\n  background: rgba(255, 255, 255, 0.9);\r\n`;\r\n\r\nconst InputForm = styled.form`\r\n  display: flex;\r\n  gap: 15px;\r\n  align-items: flex-end;\r\n`;\r\n\r\nconst MessageInput = styled.textarea`\r\n  flex: 1;\r\n  padding: 15px 20px;\r\n  border: 2px solid #e1e5e9;\r\n  border-radius: 25px;\r\n  font-size: 1rem;\r\n  resize: none;\r\n  min-height: 50px;\r\n  max-height: 120px;\r\n  font-family: inherit;\r\n  transition: all 0.3s ease;\r\n  background: #f8f9fa;\r\n\r\n  &:focus {\r\n    outline: none;\r\n    border-color: #667eea;\r\n    background: white;\r\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\r\n  }\r\n`;\r\n\r\nconst SendButton = styled(motion.button)`\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 50%;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  color: white;\r\n  border: none;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  font-size: 1.2rem;\r\n  transition: all 0.3s ease;\r\n\r\n  &:hover {\r\n    transform: scale(1.1);\r\n    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);\r\n  }\r\n\r\n  &:disabled {\r\n    opacity: 0.6;\r\n    cursor: not-allowed;\r\n    transform: none;\r\n  }\r\n`;\r\n\r\nconst TypingIndicator = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 15px 20px;\r\n  color: #666;\r\n  font-style: italic;\r\n`;\r\n\r\nconst TypingDots = styled.div`\r\n  display: flex;\r\n  gap: 4px;\r\n`;\r\n\r\nconst Dot = styled.div`\r\n  width: 8px;\r\n  height: 8px;\r\n  border-radius: 50%;\r\n  background: #667eea;\r\n  animation: typing 1.4s infinite ease-in-out;\r\n\r\n  &:nth-child(1) { animation-delay: -0.32s; }\r\n  &:nth-child(2) { animation-delay: -0.16s; }\r\n  &:nth-child(3) { animation-delay: 0s; }\r\n\r\n  @keyframes typing {\r\n    0%, 80%, 100% {\r\n      transform: scale(0.8);\r\n      opacity: 0.5;\r\n    }\r\n    40% {\r\n      transform: scale(1);\r\n      opacity: 1;\r\n    }\r\n  }\r\n`;\r\n\r\nconst WelcomeMessage = styled.div`\r\n  text-align: center;\r\n  padding: 40px;\r\n  color: #666;\r\n`;\r\n\r\nconst WelcomeTitle = styled.h3`\r\n  font-size: 1.5rem;\r\n  margin-bottom: 10px;\r\n  color: #333;\r\n`;\r\n\r\nconst WelcomeText = styled.p`\r\n  font-size: 1.1rem;\r\n  line-height: 1.6;\r\n  max-width: 500px;\r\n  margin: 0 auto;\r\n`;\r\n\r\nfunction Chat({ user }) {\r\n  const { conversationId } = useParams();\r\n  const navigate = useNavigate();\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [typing, setTyping] = useState(false);\r\n  const [socket, setSocket] = useState(null);\r\n  const messagesEndRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Initialize socket connection\r\n    const newSocket = io('http://localhost:5000');\r\n    setSocket(newSocket);\r\n\r\n    if (conversationId) {\r\n      newSocket.emit('join-conversation', conversationId);\r\n      fetchMessages();\r\n    }\r\n\r\n    newSocket.on('new-message', (message) => {\r\n      setMessages(prev => [...prev, message]);\r\n      setTyping(false);\r\n    });\r\n\r\n    newSocket.on('error', (error) => {\r\n      toast.error(error.error);\r\n    });\r\n\r\n    return () => newSocket.close();\r\n  }, [conversationId]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const fetchMessages = async () => {\r\n    try {\r\n      const response = await axios.get(`/api/messages/${conversationId}`);\r\n      setMessages(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching messages:', error);\r\n      toast.error('Failed to load messages');\r\n    }\r\n  };\r\n\r\n  const createNewConversation = async () => {\r\n    try {\r\n      const response = await axios.post('/api/conversations', {\r\n        userId: user.userId,\r\n        title: 'New Conversation'\r\n      });\r\n      navigate(`/chat/${response.data.conversationId}`);\r\n    } catch (error) {\r\n      console.error('Error creating conversation:', error);\r\n      toast.error('Failed to create conversation');\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!newMessage.trim() || loading) return;\r\n\r\n    const messageText = newMessage.trim();\r\n    setNewMessage('');\r\n    setLoading(true);\r\n    setTyping(true);\r\n\r\n    if (!conversationId) {\r\n      // Create new conversation\r\n      try {\r\n        const response = await axios.post('/api/conversations', {\r\n          userId: user.userId,\r\n          title: messageText.substring(0, 50) + '...'\r\n        });\r\n        navigate(`/chat/${response.data.conversationId}`);\r\n        \r\n        // Send message after navigation\r\n        setTimeout(() => {\r\n          socket.emit('send-message', {\r\n            message: messageText,\r\n            conversationId: response.data.conversationId,\r\n            userId: user.userId,\r\n            personalityId: null\r\n          });\r\n        }, 100);\r\n      } catch (error) {\r\n        console.error('Error creating conversation:', error);\r\n        toast.error('Failed to create conversation');\r\n        setLoading(false);\r\n        setTyping(false);\r\n      }\r\n    } else {\r\n      // Send message to existing conversation\r\n      socket.emit('send-message', {\r\n        message: messageText,\r\n        conversationId,\r\n        userId: user.userId,\r\n        personalityId: null\r\n      });\r\n    }\r\n  };\r\n\r\n  const formatTime = (timestamp) => {\r\n    return new Date(timestamp).toLocaleTimeString([], { \r\n      hour: '2-digit', \r\n      minute: '2-digit' \r\n    });\r\n  };\r\n\r\n  if (!conversationId) {\r\n    return (\r\n      <ChatContainer>\r\n        <ChatHeader>\r\n          <HeaderTitle>\r\n            <FiMessageCircle />\r\n            New Chat\r\n          </HeaderTitle>\r\n        </ChatHeader>\r\n        <WelcomeMessage>\r\n          <WelcomeTitle>Start a New Conversation</WelcomeTitle>\r\n          <WelcomeText>\r\n            Begin chatting with your AI companion. Share your thoughts, ask questions, \r\n            or just have a casual conversation. Your AI will remember your preferences \r\n            and use your custom knowledge to provide personalized responses.\r\n          </WelcomeText>\r\n        </WelcomeMessage>\r\n        <InputContainer>\r\n          <InputForm onSubmit={handleSubmit}>\r\n            <MessageInput\r\n              ref={inputRef}\r\n              value={newMessage}\r\n              onChange={(e) => setNewMessage(e.target.value)}\r\n              placeholder=\"Type your message here...\"\r\n              rows={1}\r\n              onKeyPress={(e) => {\r\n                if (e.key === 'Enter' && !e.shiftKey) {\r\n                  e.preventDefault();\r\n                  handleSubmit(e);\r\n                }\r\n              }}\r\n            />\r\n            <SendButton\r\n              type=\"submit\"\r\n              disabled={!newMessage.trim() || loading}\r\n              whileHover={{ scale: 1.1 }}\r\n              whileTap={{ scale: 0.9 }}\r\n            >\r\n              <FiSend />\r\n            </SendButton>\r\n          </InputForm>\r\n        </InputContainer>\r\n      </ChatContainer>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <ChatContainer>\r\n      <ChatHeader>\r\n        <HeaderTitle>\r\n          <FiMessageCircle />\r\n          Chat\r\n        </HeaderTitle>\r\n        <NewChatButton\r\n          onClick={createNewConversation}\r\n          whileHover={{ scale: 1.05 }}\r\n          whileTap={{ scale: 0.95 }}\r\n        >\r\n          <FiPlus />\r\n          New Chat\r\n        </NewChatButton>\r\n      </ChatHeader>\r\n\r\n      <MessagesContainer>\r\n        <AnimatePresence>\r\n          {messages.map((message, index) => (\r\n            <Message\r\n              key={message.id || index}\r\n              sender={message.sender}\r\n              initial={{ opacity: 0, y: 20 }}\r\n              animate={{ opacity: 1, y: 0 }}\r\n              transition={{ duration: 0.3 }}\r\n            >\r\n              <MessageAvatar sender={message.sender}>\r\n                {message.sender === 'user' ? <FiUser /> : <FiBot />}\r\n              </MessageAvatar>\r\n              <div>\r\n                <MessageContent sender={message.sender}>\r\n                  {message.content}\r\n                </MessageContent>\r\n                <MessageTime sender={message.sender}>\r\n                  {formatTime(message.timestamp)}\r\n                </MessageTime>\r\n              </div>\r\n            </Message>\r\n          ))}\r\n        </AnimatePresence>\r\n\r\n        {typing && (\r\n          <Message sender=\"ai\">\r\n            <MessageAvatar sender=\"ai\">\r\n              <FiBot />\r\n            </MessageAvatar>\r\n            <div>\r\n              <TypingIndicator>\r\n                AI is typing\r\n                <TypingDots>\r\n                  <Dot />\r\n                  <Dot />\r\n                  <Dot />\r\n                </TypingDots>\r\n              </TypingIndicator>\r\n            </div>\r\n          </Message>\r\n        )}\r\n\r\n        <div ref={messagesEndRef} />\r\n      </MessagesContainer>\r\n\r\n      <InputContainer>\r\n        <InputForm onSubmit={handleSubmit}>\r\n          <MessageInput\r\n            ref={inputRef}\r\n            value={newMessage}\r\n            onChange={(e) => setNewMessage(e.target.value)}\r\n            placeholder=\"Type your message here...\"\r\n            rows={1}\r\n            onKeyPress={(e) => {\r\n              if (e.key === 'Enter' && !e.shiftKey) {\r\n                e.preventDefault();\r\n                handleSubmit(e);\r\n              }\r\n            }}\r\n          />\r\n          <SendButton\r\n            type=\"submit\"\r\n            disabled={!newMessage.trim() || loading}\r\n            whileHover={{ scale: 1.1 }}\r\n            whileTap={{ scale: 0.9 }}\r\n          >\r\n            <FiSend />\r\n          </SendButton>\r\n        </InputForm>\r\n      </InputContainer>\r\n    </ChatContainer>\r\n  );\r\n}\r\n\r\nexport default Chat; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}